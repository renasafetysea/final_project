# Итоговый проект №5

## Служба такси

<b>Стек проекта:</b>


1. В качестве СУБД использован Postgres, поскольку таблица не требует высокой скорости чтения для аналитики и при расширении функционала БД службы такси она скорее будет ориентирована на запись, причем небольшого количества строк за раз.

2. Язык скриптов - python, библиотеки psycopg2 для подключения к БД и обмена данными и pandas для обработки данных датафреймами, а также выгрузки данных из БД в формате parquet.

3. Проект завернут в docker-compose.

В проекте необходимо предварительно обработать данные для core-слоя и поместить их в нужную директорию.

<b>Работа с данными</b> 

1. Требуеся предварительная подготовка файла с очищенными данными. Необходимо запустить скрипт [dataframe_processing](https://github.com/renasafetysea/final_project/blob/main/app/scripts/dataframe_processing.py) и поместить полученный файл в папку init_db/data. Здесь производится преобразование формата, проверка на существование всех необходимых значений строки, их адекватность.

2. При запуске docker-compose происходит загрузка данных в БД Postgres и создние витрины данных, а также ее выгрузка в формате parquet в отдельную директорию внутри контейнера.


<b>Структура проекта</b>

![image](https://github.com/renasafetysea/final_project/blob/main/figs/structure.PNG)

<i>Прим. разделы figs и results не используются для работы docker-compose и необходимы только для демонстрации проекта</i>

<b>Результаты</b>

Получены 3 слоя БД: 

RAW:

![image](https://github.com/renasafetysea/final_project/blob/main/figs/er_raw.PNG)

CORE: 

![image](https://github.com/renasafetysea/final_project/blob/main/figs/er_core.PNG)

MART:

![image](https://github.com/renasafetysea/final_project/blob/main/figs/er_mart.PNG)

Витрина данных содержит информацию о процентном соотношении поездок такси с различным количеством пассажиров по датам:

![image](https://github.com/renasafetysea/final_project/blob/main/figs/data_mart.PNG)

Также составлена витрина для получения информации о минимальной и максимальной стоимости поездки за день:

![image](https://github.com/renasafetysea/final_project/blob/main/figs/min_max_cost_dm.PNG)

<b>Попытка ответа на дополнительный вопрос</b>

Скрипт [data_analysis](https://github.com/renasafetysea/final_project/blob/main/app/scripts/data_analysis.py) (не инициализируется docker-compose) содержит программу для построения графика рассеяния, отвечающего на вопрос "Как количество пассажиров и дальность поездки влияют на чаевые?".

Получен график:

![image](https://github.com/renasafetysea/final_project/blob/main/app/scripts/scatter_plot_1-2.png)

<b>Выводы:</b>

Получен работоспособный проект, инициализирующий БД службы такси, состоящую из трех слоев данных. Написаны скрипты для обработки и очистки сырых данных и получения витрины. 

При ответе на дополнительный вопрос сделан вывод, что чаще всего таксист получает большую сумму чаевых при поездке на расстояние 50-100, если в машине находятся 1, 2 или 5 человек.

Проект можно доработать улучшив качество очистки данных при инициализации core-слоя и обработки данных при аналитике, а также оптимизировав его с точки зрения затрат памяти.
